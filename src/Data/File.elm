module Data.File exposing (FileReadStatus(..), fileReadStatusDecoder)

import Json.Decode


type FileReadStatus
    = ReadError
    | Success String String


fileReadStatusDecoder : Json.Decode.Decoder FileReadStatus
fileReadStatusDecoder =
    Json.Decode.field "status" Json.Decode.string
        |> Json.Decode.andThen
            (\status ->
                case status of
                    "Success" ->
                        Json.Decode.map2
                            (\f c -> Success f c)
                            (Json.Decode.field "filename" Json.Decode.string)
                            (Json.Decode.field "contents" Json.Decode.string)

                    _ ->
                        Json.Decode.succeed ReadError
            )
